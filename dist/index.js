!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.websdk=e():t.websdk=e()}(globalThis,(function(){return function(t){var e={};function r(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)r.d(n,o,function(e){return t[e]}.bind(null,o));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=6)}([function(t,e,r){"use strict";var n,o;Object.defineProperty(e,"__esModule",{value:!0}),e.AppType=e.ClientType=void 0,function(t){t[t.Web=0]="Web",t[t.App=1]="App"}(n||(e.ClientType=n={})),function(t){t[t.Pc=0]="Pc",t[t.Android=1]="Android",t[t.Ios=2]="Ios"}(o||(e.AppType=o={}))},function(t,e,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(e,r);o&&!("get"in o?!e.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,o)}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]}),o=this&&this.__exportStar||function(t,e){for(var r in t)"default"===r||Object.prototype.hasOwnProperty.call(e,r)||n(e,t,r)};Object.defineProperty(e,"__esModule",{value:!0}),o(r(9),e),o(r(4),e),o(r(10),e),o(r(7),e),o(r(8),e),o(r(12),e)},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.createWin=e.createIos=e.createAndroid=void 0;var n=r(0),o=function(){function t(t,e,r,n,o){void 0===n&&(n=window.prompt),void 0===o&&(o=window.console),this.clientType=t,this.appType=e,this.salt=r,this.prompt=n,this.console=o,this._listeners={},this._handlers={},this.log("constructor","clientType=".concat(t," appType=").concat(e," salt=").concat(r," prompt=").concat(!!n))}return t.prototype.init=function(t){this.salt=t,this.log("init","salt=".concat(this.salt))},t.prototype.invoke=function(t,e,r){var n=void 0,o=this._handlers[t];if(o)try{var i=this.atob(e),s=r?i:i&&JSON.parse(i)||null;n=(o.apply(null,[s])||void 0)&&JSON.stringify(n)||void 0}catch(t){n=void 0}return this.log("invoke","handler=".concat(!!o," key=").concat(t," base64=").concat(e," packed=").concat(r," result=").concat(n)),n},t.prototype.emit=function(t,e,r){var n=this._listeners[t];if(n)try{var o=this.atob(e),i=r?o:o&&JSON.parse(o)||null;n.apply(null,[i])}catch(t){}this.log("emit","listener=".concat(!!n," key=").concat(t," base64=").concat(e," packed=").concat(r))},t.prototype.excute=function(t,e){return void 0===e&&(e={}),this.call(t,e)},t.prototype.on=function(t,e){this.log("on","key=".concat(t," listener=").concat(!!e)),this._listeners[t]=e},t.prototype.off=function(t){this.log("off","key=".concat(t)),delete this._listeners[t]},t.prototype.register=function(t,e){this.log("on","key=".concat(t," handler=").concat(!!e)),this._handlers[t]=e},t.prototype.call=function(t,e){var r,n,o=void 0,i=void 0,s="",u=(null===(r=window.performance)||void 0===r?void 0:r.now())||0;if(this.prompt)try{s=JSON.stringify({key:t,params:e,salt:this.salt}),i=this.prompt("webview://app?args="+s)||"{}",o=JSON.parse(i)}catch(t){o=void 0}return u=(null===(n=window.performance)||void 0===n?void 0:n.now())||0-u,this.log("call","key=".concat(t," args=").concat(s," result=").concat(!!o," lt=").concat(u)),o},t.prototype.atob=function(t){return(window.atob||function(t){for(var e=function(t){for(var e={},r=0,n=t.length;r<n;++r)e[t.charAt(r)]=r;return e}("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),r=String.fromCharCode,n=-1,o=0,i=[],s=t.replace(/\s|=/g,"");o<s.length;){var u=e[s.charAt(o)];switch(o%4){case 0:break;case 1:i.push(r(n<<2|u>>4));break;case 2:i.push(r((15&n)<<4|u>>2));break;case 3:i.push(r((3&n)<<6|u))}n=u,++o}return i.join("")})(t)},t.prototype.log=function(t,e){var r;void 0===e&&(e=""),null===(r=this.console)||void 0===r||r.log("Websdk.Win",t,e)},t}();e.createAndroid=function(){return new o(n.ClientType.App,n.AppType.Android)};e.createIos=function(){return new o(n.ClientType.App,n.AppType.Ios)};e.createWin=function(t,e,r,n){return new o(t,e,r,n)}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Emitter=void 0;var n=function(){function t(){}return Object.defineProperty(t,"UP",{get:function(){return"Emitter.UP"},enumerable:!1,configurable:!0}),Object.defineProperty(t,"DOWN",{get:function(){return"Emitter.DOWN"},enumerable:!1,configurable:!0}),t}();e.Emitter=n},function(t,e,r){"use strict";var n,o=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s},s=this&&this.__spreadArray||function(t,e,r){if(r||2===arguments.length)for(var n,o=0,i=e.length;o<i;o++)!n&&o in e||(n||(n=Array.prototype.slice.call(e,0,o)),n[o]=e[o]);return t.concat(n||Array.prototype.slice.call(e))};Object.defineProperty(e,"__esModule",{value:!0}),e.getAgent=e.UDate=e.paramFmt=e.argObject=e.urlArgs=e.getArgs=e.format=e.uuid=void 0;var u=0;e.uuid=function(){return++u};e.format=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];var n=/{%(\d+)}/g;return n.test(t)&&(t=t.replace(n,(function(t,r){var n=e[r-1];if(n&&"string"!=typeof n&&"number"!=typeof n)try{n=JSON.stringify(n)}catch(t){n="{stringify error}"}return n}))),t};var a;e.getArgs=function(){var t=location.search||location.href||"",e=t.indexOf("?");return e>=0&&t.substr(e+1)||""};e.urlArgs=function(t){if(!a){var e=t.indexOf("?"),r=/([^&]+?)=([^#&]+)/g,n={};for(t=t.substr(e+1);r.test(t);)n[RegExp.$1]=RegExp.$2;a=n}return a};e.argObject=function(){var t=(location.search||location.href||"").slice(1);return(0,e.urlArgs)(t)};e.paramFmt=function(t){return{url:t,arg:function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return e.format.apply(void 0,s([t],i(r),!1))}}};var c,l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.format=function(t){var e={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),"S+":this.getMilliseconds()};for(var r in/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))),e)if(new RegExp("("+r+")").test(t)){for(var n="",o=1;o<=RegExp.$1.length;o++)n+="0";var i="";if(1==RegExp.$1.length)i=e[r];else i=n=(n+=e[r]).substr((""+e[r]).length);t=t.replace(RegExp.$1,i)}return t},e}(Date);e.UDate=l;e.getAgent=function(){if(!c){var t=navigator.userAgent;c={agent:t,trident:t.indexOf("Trident")>-1,presto:t.indexOf("Presto")>-1,webKit:t.indexOf("AppleWebKit")>-1,gecko:t.indexOf("Gecko")>-1&&-1===t.indexOf("KHTML"),mobile:!!t.match(/AppleWebKit.*Mobile.*/),ios:!!t.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:t.indexOf("Android")>-1||t.indexOf("Adr")>-1,iPhone:t.indexOf("iPhone")>-1,iPad:t.indexOf("iPad")>-1,iPod:t.indexOf("iPod")>-1,webApp:-1===t.indexOf("Safari")}}return c}},function(t,e,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(e,r);o&&!("get"in o?!e.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,o)}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]}),o=this&&this.__exportStar||function(t,e){for(var r in t)"default"===r||Object.prototype.hasOwnProperty.call(e,r)||n(e,t,r)};Object.defineProperty(e,"__esModule",{value:!0}),o(r(17),e),o(r(18),e),o(r(19),e),o(r(20),e),o(r(0),e),o(r(21),e)},function(t,e,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(e,r);o&&!("get"in o?!e.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,o)}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]}),o=this&&this.__exportStar||function(t,e){for(var r in t)"default"===r||Object.prototype.hasOwnProperty.call(e,r)||n(e,t,r)};Object.defineProperty(e,"__esModule",{value:!0}),o(r(1),e),o(r(13),e),o(r(5),e)},function(t,e,r){"use strict";var n,o=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.UBase=void 0;var s=i(r(11)),u=r(4),a=function(t){function e(){var e=t.call(this)||this;return e._uuid=(0,u.uuid)(),e}return o(e,t),Object.defineProperty(e.prototype,"uuid",{get:function(){return this._uuid},enumerable:!1,configurable:!0}),e}(s.default);e.UBase=a},function(t,e,r){"use strict";var n,o=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s},s=this&&this.__spreadArray||function(t,e,r){if(r||2===arguments.length)for(var n,o=0,i=e.length;o<i;o++)!n&&o in e||(n||(n=Array.prototype.slice.call(e,0,o)),n[o]=e[o]);return t.concat(n||Array.prototype.slice.call(e))};Object.defineProperty(e,"__esModule",{value:!0}),e.Dispatch=void 0;var u=function(t){function e(){var e=t.call(this)||this;return e._stoped=!1,e}return o(e,t),e.prototype.emit=function(e){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];return!this._stoped&&t.prototype.emit.apply(this,s([e],i(r),!1))},e.prototype.init=function(){this._stoped=!1,this.emit(e.ONINIT)},e.prototype.start=function(){this._stoped=!1,this.emit(e.ONSTART)},e.prototype.stop=function(){this.emit(e.ONSTOP),t.prototype.removeAllListeners.call(this),this._stoped=!0},e.prototype.destroy=function(){this.emit(e.ONDESTROY),this._stoped=!0,t.prototype.removeAllListeners.call(this)},Object.defineProperty(e,"ONINIT",{get:function(){return"Dispatch.ONINIT"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"ONSTART",{get:function(){return"Dispatch.ONSTART"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"ONSTOP",{get:function(){return"Dispatch.ONSTOP"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"ONDESTROY",{get:function(){return"Dispatch.ONDESTROY"},enumerable:!1,configurable:!0}),e}(r(7).UBase);e.Dispatch=u},function(t,e,r){"use strict";var n,o,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.CRect=e.CShape=e.CPoint=e.CSize=e.SHAPES=void 0,function(t){t[t.SHAPE=-1]="SHAPE",t[t.POLY=0]="POLY",t[t.RECT=1]="RECT",t[t.CIRC=2]="CIRC",t[t.ELIP=3]="ELIP",t[t.RREC=4]="RREC"}(o||(e.SHAPES=o={}));var s=function(){function t(t,e){this._width=t||0,this._height=e||0}return Object.defineProperty(t.prototype,"width",{get:function(){return this._width},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height},enumerable:!1,configurable:!0}),t.prototype.clone=function(){return new t(this._width,this._height)},t.prototype.assign=function(t){var e=t.width,r=t.height,n=!1;return this._width===e&&this._height===r||(this._width=e,this._height=r,n=!0),n},t.prototype.contains=function(t){var e=t.width,r=t.height;return this._width===e&&this._height===r},t.prototype.equal=function(t){var e=t.width,r=t.height;return e===this._width&&r===this._height},t}();e.CSize=s;var u=function(){function t(t,e){this._x=t||0,this._y=e||0}return Object.defineProperty(t.prototype,"x",{get:function(){return this._x},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},enumerable:!1,configurable:!0}),t.prototype.clone=function(){return new t(this.x,this.y)},t.prototype.assign=function(t){var e=t.x,r=t.y,n=!1;return this._x===e&&this._y===r||(this._x=e,this._y=r,n=!0),n},t.prototype.contains=function(t){var e=t.x,r=t.y;return this.x===e&&this.y===r},t.prototype.equal=function(t){var e=t.x,r=t.y;return e===this.x&&r===this.y},t}();e.CPoint=u;var a=function(t){function e(e,r,n){var i=t.call(this,r,n)||this;return i._kind=e||o.SHAPE,i}return i(e,t),Object.defineProperty(e.prototype,"empty",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"kind",{get:function(){return this._kind},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bounds",{get:function(){return{x:this.x,y:this.y,width:0,height:0}},enumerable:!1,configurable:!0}),e.prototype.clone=function(){return new e(this.x,this.y)},e.prototype.assign=function(e){return t.prototype.assign.call(this,e)},e.prototype.contains=function(t){var e=t.x,r=t.y;return this.x===e&&this.y===r},e.prototype.equal=function(e){return t.prototype.equal.call(this,e)&&this._kind===e.kind},e}(u);e.CShape=a;var c=function(t){function e(e,r,n,i){var s=t.call(this,o.RECT,e,r)||this;return s._width=n||0,s._height=i||0,s}return i(e,t),Object.defineProperty(e,"EMPTY",{get:function(){return new e(0,0,0,0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"left",{get:function(){return this.x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"right",{get:function(){return this.x+this._width},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"top",{get:function(){return this.y},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bottom",{get:function(){return this.y+this._height},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this._width},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"empty",{get:function(){return 0===this._width||0===this._height},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bounds",{get:function(){return{x:this.x,y:this.y,width:this._width,height:this._height}},enumerable:!1,configurable:!0}),e.prototype.clone=function(){return new e(this.x,this.y,this._width,this._height)},e.prototype.assign=function(e){var r=t.prototype.assign.call(this,e);return this._width===e.width&&this._height===e.height||(this._width=e.width,this._height=e.height,r=!0),r},e.prototype.contains=function(t){var e=t.x,r=t.y;return!(this._width<=0||this._height<=0)&&(e>=this.x&&e<this.x+this._width&&r>=this.y&&r<this.y+this._height)},e.prototype.pad=function(t,e){return t=t||0,e=e||(0!==e?t:0),this._x-=t,this._y-=e,this._width+=2*t,this._height+=2*e,this},e.prototype.fit=function(t){var e=t.x,r=t.y,n=t.width,o=t.height;return this.x<e&&(this._width+=this.x,this._width<0&&(this._width=0),this._x=e),this._y<r&&(this._height+=this._y,this._height<0&&(this._height=0),this._y=r),this._x+this._width>e+n&&(this._width=n-this._x,this._width<0&&(this._width=0)),this._y+this._height>r+o&&(this._height=o-this._y,this._height<0&&(this._height=0)),this},e.prototype.enlarge=function(t){var e=t.x,r=t.y,n=t.width,o=t.height,i=Math.min(this._x,e),s=Math.max(this._x+this._width,e+n),u=Math.min(this._y,r),a=Math.max(this._y+this._height,r+o);return this._x=i,this._width=s-i,this._y=u,this._height=a-u,this},e.prototype.equal=function(e){return t.prototype.equal.call(this,e)&&e.width===this._width&&e.height===this._height},e}(a);e.CRect=c},function(t,e,r){"use strict";var n=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s},o=this&&this.__spreadArray||function(t,e,r){if(r||2===arguments.length)for(var n,o=0,i=e.length;o<i;o++)!n&&o in e||(n||(n=Array.prototype.slice.call(e,0,o)),n[o]=e[o]);return t.concat(n||Array.prototype.slice.call(e))};Object.defineProperty(e,"__esModule",{value:!0}),e.Handler=void 0;var i=r(4),s=function(){function t(t,e){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];this._caller=t,this._method=e,this._args=r||[],this._uuid=(0,i.uuid)()}return t.prototype.apply=function(){for(var t,e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return null===(t=this._method)||void 0===t?void 0:t.apply(this._caller||null,o(o([],n(this._args||[]),!1),n(e),!1))},t.prototype.call=function(){for(var t,e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return null===(t=this._method)||void 0===t?void 0:t.call.apply(t,o([this._caller||null],n(o(o([],n(this._args||[]),!1),n(e),!1)),!1))},t.prototype.destroy=function(){this._caller=null,this._method=null,this._args=[]},Object.defineProperty(t.prototype,"caller",{get:function(){return this._caller},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"method",{get:function(){return this._method},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"args",{get:function(){return this._args},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"uuid",{get:function(){return this._uuid},enumerable:!1,configurable:!0}),t.excute=function(t,e){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return new Promise((function(n){n(null==e?void 0:e.apply(t||null,r))}))},t}();e.Handler=s},function(t,e,r){"use strict";var n=Object.prototype.hasOwnProperty,o="~";function i(){}function s(t,e,r){this.fn=t,this.context=e,this.once=r||!1}function u(t,e,r,n,i){if("function"!=typeof r)throw new TypeError("The listener must be a function");var u=new s(r,n||t,i),a=o?o+e:e;return t._events[a]?t._events[a].fn?t._events[a]=[t._events[a],u]:t._events[a].push(u):(t._events[a]=u,t._eventsCount++),t}function a(t,e){0==--t._eventsCount?t._events=new i:delete t._events[e]}function c(){this._events=new i,this._eventsCount=0}Object.create&&(i.prototype=Object.create(null),(new i).__proto__||(o=!1)),c.prototype.eventNames=function(){var t,e,r=[];if(0===this._eventsCount)return r;for(e in t=this._events)n.call(t,e)&&r.push(o?e.slice(1):e);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(t)):r},c.prototype.listeners=function(t){var e=o?o+t:t,r=this._events[e];if(!r)return[];if(r.fn)return[r.fn];for(var n=0,i=r.length,s=new Array(i);n<i;n++)s[n]=r[n].fn;return s},c.prototype.listenerCount=function(t){var e=o?o+t:t,r=this._events[e];return r?r.fn?1:r.length:0},c.prototype.emit=function(t,e,r,n,i,s){var u=o?o+t:t;if(!this._events[u])return!1;var a,c,l=this._events[u],p=arguments.length;if(l.fn){switch(l.once&&this.removeListener(t,l.fn,void 0,!0),p){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,e),!0;case 3:return l.fn.call(l.context,e,r),!0;case 4:return l.fn.call(l.context,e,r,n),!0;case 5:return l.fn.call(l.context,e,r,n,i),!0;case 6:return l.fn.call(l.context,e,r,n,i,s),!0}for(c=1,a=new Array(p-1);c<p;c++)a[c-1]=arguments[c];l.fn.apply(l.context,a)}else{var h,f=l.length;for(c=0;c<f;c++)switch(l[c].once&&this.removeListener(t,l[c].fn,void 0,!0),p){case 1:l[c].fn.call(l[c].context);break;case 2:l[c].fn.call(l[c].context,e);break;case 3:l[c].fn.call(l[c].context,e,r);break;case 4:l[c].fn.call(l[c].context,e,r,n);break;default:if(!a)for(h=1,a=new Array(p-1);h<p;h++)a[h-1]=arguments[h];l[c].fn.apply(l[c].context,a)}}return!0},c.prototype.on=function(t,e,r){return u(this,t,e,r,!1)},c.prototype.once=function(t,e,r){return u(this,t,e,r,!0)},c.prototype.removeListener=function(t,e,r,n){var i=o?o+t:t;if(!this._events[i])return this;if(!e)return a(this,i),this;var s=this._events[i];if(s.fn)s.fn!==e||n&&!s.once||r&&s.context!==r||a(this,i);else{for(var u=0,c=[],l=s.length;u<l;u++)(s[u].fn!==e||n&&!s[u].once||r&&s[u].context!==r)&&c.push(s[u]);c.length?this._events[i]=1===c.length?c[0]:c:a(this,i)}return this},c.prototype.removeAllListeners=function(t){var e;return t?(e=o?o+t:t,this._events[e]&&a(this,e)):(this._events=new i,this._eventsCount=0),this},c.prototype.off=c.prototype.removeListener,c.prototype.addListener=c.prototype.on,c.prefixed=o,c.EventEmitter=c,t.exports=c},function(t,e,r){"use strict";var n,o=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))((function(o,i){function s(t){try{a(n.next(t))}catch(t){i(t)}}function u(t){try{a(n.throw(t))}catch(t){i(t)}}function a(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(s,u)}a((n=n.apply(t,e||[])).next())}))},s=this&&this.__generator||function(t,e){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(u){return function(a){return function(u){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,u[0]&&(s=0)),s;)try{if(r=1,n&&(o=2&u[0]?n.return:u[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,u[1])).done)return o;switch(n=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return s.label++,{value:u[1],done:!1};case 5:s.label++,n=u[1],u=[0];continue;case 7:u=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==u[0]&&2!==u[0])){s=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){s.label=u[1];break}if(6===u[0]&&s.label<o[1]){s.label=o[1],o=u;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(u);break}o[2]&&s.ops.pop(),s.trys.pop();continue}u=e.call(t,s)}catch(t){u=[6,t],n=0}finally{r=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,a])}}},u=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s},a=this&&this.__spreadArray||function(t,e,r){if(r||2===arguments.length)for(var n,o=0,i=e.length;o<i;o++)!n&&o in e||(n||(n=Array.prototype.slice.call(e,0,o)),n[o]=e[o]);return t.concat(n||Array.prototype.slice.call(e))};Object.defineProperty(e,"__esModule",{value:!0}),e.useExcuter=e.Excuter=e.HolderPtr=e.ExcuterPtr=e.ExNode=void 0;var c=function(t){function e(e){var r=t.call(this)||this;return r._key=e,r._ready=!1,r._active=!1,r}return o(e,t),e.prototype.debug=function(t,e){console.info(t,e)},Object.defineProperty(e,"READY",{get:function(){return"ExNode.READY"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"CHANGED",{get:function(){return"ExNode.CHANGED"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"key",{get:function(){return this._key},set:function(t){this._key=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"active",{get:function(){return this._active},set:function(t){this._active=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ready",{get:function(){return this._ready},set:function(t){this._ready!==t&&(this._ready=t,this.debug("ready","Node:[".concat(this.key,"] ready=").concat(t)),this.emit(e.READY,this._ready))},enumerable:!1,configurable:!0}),e.prototype.change=function(){this.emit(e.CHANGED)},e.prototype.wait=function(t){var e=this,r=function(){return e._ready};return new Promise((function(n,o){var i=r();if(i||e._stoped)n(i);else var s=0,u=Math.ceil(t/100),a=setInterval((function(){((i=r())||++s>=u||e._stoped)&&(clearInterval(a),n(i))}),100)}))},e.prototype.reduce=function(t){var e=this;return new Promise((function(r){var n=[];t.reduce((function(o,u,a){return o.then((function(){return i(e,void 0,void 0,(function(){var e,o;return s(this,(function(i){switch(i.label){case 0:return o=(e=n).push,[4,u];case 1:return o.apply(e,[i.sent()]),a>=t.length-1&&r(n),[2]}}))}))}))}),Promise.resolve())}))},e.key="",e.debug=function(t,e){console.info(t,e)},e}(r(8).Dispatch);e.ExNode=c;var l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(c);e.ExcuterPtr=l;var p=function(t){function e(e){var r=t.call(this,"")||this;return r.reset(e),r.handleReady=r.handleReady.bind(r),r.handleChange=r.handleChange.bind(r),r}return o(e,t),Object.defineProperty(e.prototype,"itr",{get:function(){return this._itr},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"valid",{get:function(){return!!this._itr},enumerable:!1,configurable:!0}),e.prototype.reset=function(t){var e,r,n,o;null===(e=this._itr)||void 0===e||e.off(c.READY,this.handleReady),null===(r=this._itr)||void 0===r||r.off(c.CHANGED,this.handleReady),this.key="".concat((null==t?void 0:t.key)||"",".Holder"),this._itr=t,null===(n=this._itr)||void 0===n||n.on(c.READY,this.handleReady),null===(o=this._itr)||void 0===o||o.on(c.CHANGED,this.handleReady)},e.prototype.destroy=function(){var e,r;null===(e=this._itr)||void 0===e||e.off(c.READY,this.handleReady),null===(r=this._itr)||void 0===r||r.off(c.CHANGED,this.handleReady),this._itr=void 0,t.prototype.destroy.call(this)},e.prototype.handleReady=function(t){this.ready=t},e.prototype.handleChange=function(){this.change()},e}(c);e.HolderPtr=p;var h=function(t){function e(e){var r=t.call(this,e)||this;return r._childs=new Map,r}return o(e,t),Object.defineProperty(e,"UP",{get:function(){return"Excuter.UP"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"DWON",{get:function(){return"Excuter.DWON"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"ADD",{get:function(){return"Excuter.ADD"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"REMOVE",{get:function(){return"Excuter.REMOVE"},enumerable:!1,configurable:!0}),e.prototype.excute=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];var n=this[t];return null==n?void 0:n.call.apply(n,a([this],u(e),!1))},e.prototype.get=function(t){var e=t.key;return this._childs.get(e)},e.prototype.fetch=function(t){var r=this;return new Promise((function(n){var o=function(){var e=r.get(t);e?s(e):(r.can(t)&&r.up(t),null==(e=r.get(t))||e.on(t.READY,s),(null==e?void 0:e.ready)&&s(e))},i=function(e){t.key===e.key&&o()},s=function(o){o.off(t.READY,s),r.off(e.ADD,i),n(o)};r.on(e.ADD,i),o()}))},e.prototype.as=function(t){var e=t.key;if(!this._childs.has(e))throw this.debug("as","Node:[".concat(this.key,"] as [").concat(e,"] error")),new Error("Excuter has not ".concat(e));return this._childs.get(e)},e.prototype.has=function(t){var e=t.key;return this._childs.has(e)},e.prototype.can=function(t){var e=t.key,r=this._childs.get(e);return!!r&&!r.active},e.prototype.up=function(t,r){var n=t.key;return i(this,void 0,void 0,(function(){var t,o,a,c,l=this;return s(this,(function(p){switch(p.label){case 0:return n&&(this._childs.has(n)||r)?(r&&!this._childs.has(n)&&this._childs.set(n,r),(t=this._childs.get(n))?t.active?[3,2]:(t.active=!0,[4,this.watch((function(){return i(l,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return[4,null==t?void 0:t.init()];case 1:return e.sent(),[4,null==t?void 0:t.start()];case 2:return e.sent(),t&&(t.ready=!0),[2]}}))}))}))]):[2,!1]):[2,!1];case 1:o=u.apply(void 0,[p.sent(),3]),a=o[1],c=o[2],this.debug("up","Node:[".concat(this.key,"] up [").concat(n,"] lt=").concat(a).concat(c&&" err=".concat(c)||"")),this.emit(e.UP,{key:n}),p.label=2;case 2:return[2,!0]}}))}))},e.prototype.down=function(t){var r=t.key;return i(this,void 0,void 0,(function(){var t,n,o,a,c=this;return s(this,(function(l){switch(l.label){case 0:return(t=this._childs.get(r))?(t.active=!1,this.emit(e.DWON,{key:r}),[4,this.watch((function(){return i(c,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return t&&(t.ready=!1),[4,t.stop()];case 1:return e.sent(),[4,t.destroy()];case 2:return e.sent(),[2]}}))}))}))]):[2,!1];case 1:return n=u.apply(void 0,[l.sent(),3]),o=n[1],a=n[2],this.debug("down","Node:[".concat(this.key,"] down [").concat(r,"] lt=").concat(o).concat(a&&" err=".concat(a)||"")),[2,!0]}}))}))},e.prototype.add=function(t){var r=t.key,n=this._childs.get(r);return n||(this._childs.set(r,n=new t(r)),this.emit(e.ADD,{key:r}),this.debug("add","Node:[".concat(this.key,"] add [").concat(r,"]"))),n},e.prototype.remove=function(t){var r=t.key,n=r&&this._childs.get(r)||null;return!!n&&(n.active&&this.down({key:r}),this._childs.delete(r),this.debug("remove","Node:[".concat(this.key,"] remove [").concat(r,"]")),this.emit(e.REMOVE,{key:r}),!0)},e.prototype.init=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return i(this,void 0,void 0,(function(){var e=this;return s(this,(function(r){return t.prototype.init.call(this),this._childs.forEach((function(t){return i(e,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return[4,t.init()];case 1:return[2,e.sent()]}}))}))})),[2]}))}))},e.prototype.start=function(){return i(this,void 0,void 0,(function(){var e=this;return s(this,(function(r){return t.prototype.start.call(this),this._childs.forEach((function(t){return i(e,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return[4,t.start()];case 1:return[2,e.sent()]}}))}))})),[2]}))}))},e.prototype.stop=function(){return i(this,void 0,void 0,(function(){var e=this;return s(this,(function(r){return this._childs.forEach((function(t){return i(e,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return[4,t.stop()];case 1:return[2,e.sent()]}}))}))})),t.prototype.stop.call(this),[2]}))}))},e.prototype.destroy=function(){return i(this,void 0,void 0,(function(){var e=this;return s(this,(function(r){return this._childs.forEach((function(t){return i(e,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return[4,t.destroy()];case 1:return[2,e.sent()]}}))}))})),t.prototype.destroy.call(this),[2]}))}))},e.prototype.watch=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];return i(this,void 0,void 0,(function(){var r,n,o,i;return s(this,(function(s){switch(s.label){case 0:r=window.performance.now(),n=void 0,o=void 0,s.label=1;case 1:return s.trys.push([1,3,,4]),[4,null==t?void 0:t.apply(void 0,a([],u(e),!1))];case 2:return n=s.sent(),[3,4];case 3:return i=s.sent(),n=void 0,o=i,[3,4];case 4:return r=window.performance.now()-r,[2,[n,r,o]]}}))}))},e}(l);e.Excuter=h;e.useExcuter=function(t,e){return t.can(e)&&t.up(e),t.as(e)}},function(t,e,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(e,r);o&&!("get"in o?!e.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,o)}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]}),o=this&&this.__exportStar||function(t,e){for(var r in t)"default"===r||Object.prototype.hasOwnProperty.call(e,r)||n(e,t,r)};Object.defineProperty(e,"__esModule",{value:!0}),o(r(14),e),o(r(23),e)},function(t,e,r){"use strict";var n,o=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.createSdk=void 0;var i=r(15),s=r(16),u=r(22),a=r(5),c=r(1),l=r(2),p=function(t){function e(e){var r=t.call(this)||this,n=e.name,o=void 0===n?"":n,a=e.salt,p=void 0===a?"":a,h=e.console,f=void 0===h?window.console:h,y=e.nodes,d=void 0===y?[]:y,_=e.prompt;r._console=f;var v=r.appInfo,g=v.clientType,b=v.appType;return r._name=o,r._win=window.$Win=(0,l.createWin)(g,b,p,_),r._timer=new i.TimersImpl,r._log=new u.LogImpl(r,f),r._queues=new s.QueuesImpl(r),r._api=new c.Excuter("Sdk.Root"),d.forEach((function(t){return r._api.add(t)})),null==r||r.debug("constructor","name=".concat(o," salt=").concat(p," clientType=").concat(g," appType=").concat(b)),r}return o(e,t),e.prototype.init=function(){this._log.init(),this._timer.init(),this._queues.init(),this._api.init(),null==this||this.debug("init")},e.prototype.start=function(){this._timer.start(),this._log.start(),this._queues.start(),this._api.init(),null==this||this.debug("start")},e.prototype.stop=function(){this._api.stop(),this._timer.stop(),this._log.stop(),this._queues.stop(),null==this||this.debug("stop")},e.prototype.destroy=function(){this._api.destroy(),this._timer.destroy(),this._log.destroy(),this._queues.destroy(),null==this||this.debug("destroy")},Object.defineProperty(e.prototype,"name",{get:function(){return this._name},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"timer",{get:function(){return this._timer},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"log",{get:function(){return this._log},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"queues",{get:function(){return this._queues},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"api",{get:function(){return this._api},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"win",{get:function(){return this._win},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"args",{get:function(){return(0,c.argObject)()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"appInfo",{get:function(){var t=window.$App||{},e=t.clientType,r=t.appType;if(e=e||a.ClientType.Web,!(r=r||a.AppType.Pc)){var n=(0,c.getAgent)();n.android?r=a.AppType.Android:(n.iPhone||n.iPod||n.iPad)&&(r=a.AppType.Ios)}return{clientType:e,appType:r}},enumerable:!1,configurable:!0}),e.prototype.debug=function(t,e){var r;void 0===e&&(e=""),null===(r=this._console)||void 0===r||r.log("Websdk.Sdk",t,e)},e}(c.Dispatch);e.createSdk=function(t){return new p(t)}},function(t,e,r){"use strict";var n,o=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s},s=this&&this.__spreadArray||function(t,e,r){if(r||2===arguments.length)for(var n,o=0,i=e.length;o<i;o++)!n&&o in e||(n||(n=Array.prototype.slice.call(e,0,o)),n[o]=e[o]);return t.concat(n||Array.prototype.slice.call(e))};Object.defineProperty(e,"__esModule",{value:!0}),e.TimersImpl=void 0;var u=r(1),a=function(t){function e(e,r,n,o,u,a,c){void 0===a&&(a=0);for(var l=[],p=7;p<arguments.length;p++)l[p-7]=arguments[p];var h=t.apply(this,s([e,r],i(l),!1))||this;return h._delay=o,h._repeat=!c,h._exeTime=n,h._count=c||1,h._priority=a,h._key=u&&r||h._uuid,h}return o(e,t),e.prototype.excute=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];for(;t>=this._exeTime&&(this._repeat||this._count>0);)--this._count,this._exeTime+=this._delay,this._repeat?Promise.resolve(this.apply.apply(this,s([],i(e),!1))):this.apply.apply(this,s([],i(e),!1));return this._repeat||this._count>0},Object.defineProperty(e.prototype,"priority",{get:function(){return this._priority},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"key",{get:function(){return this._key},enumerable:!1,configurable:!0}),e}(u.Handler),c=function(t){function e(){var e=t.call(this)||this;return e._frameTasks=new Map,e._timerTasks=new Map,e._currTime=(new Date).getTime(),e._timerId=null,e._frameId=null,e.handleFrameLoop=e.handleFrameLoop.bind(e),e.handleTimerLoop=e.handleTimerLoop.bind(e),e}return o(e,t),e.prototype.destroy=function(){this.clearALL(),t.prototype.destroy.call(this)},e.prototype.clearALL=function(){this._frameTasks.clear(),this._timerTasks.clear(),this._frameId&&this.cancelAnimationFrame(this._frameId),this._timerId&&window.clearInterval(this._timerId),this._frameId=null,this._timerId=null},e.prototype.clearTimer=function(t,e){var r=this.clearTimerTask(t,e);return r=this.clearFrameTask(t,e)||r},e.prototype.hasTimer=function(t,e){return this.hasTaskTimer(this._timerTasks,t,e)||this.hasTaskTimer(this._frameTasks,t,e)},e.prototype.hasFrameTimer=function(t,e){return this.hasTaskTimer(this._frameTasks,t,e)},e.prototype.hasTimeTimer=function(t,e){return this.hasTaskTimer(this._timerTasks,t,e)},e.prototype.clearCaller=function(t){var e=this.clearTimerCaller(t);return e=this.clearFrameCaller(t)||e},e.prototype.hasTaskTimer=function(t,e,r){var n=t.get(e);return n&&(!r||n.has(r))},e.prototype.clearTimerCaller=function(t){var e=!1;return this._timerTasks.has(t)&&(this._timerTasks.delete(t),e=!0),e},e.prototype.clearFrameCaller=function(t){var e=!1;return this._frameTasks.has(t)&&(this._frameTasks.delete(t),e=!0),e},e.prototype.clearTimerTask=function(t,e){var r=this._timerTasks.get(t),n=!1;return(null==r?void 0:r.has(e))&&(r.delete(e),this.checkTimerQueue(),n=!0),n},e.prototype.clearEmptyQueue=function(t){Array.from(t.keys()).forEach((function(e){var r=t.get(e);!(null==r?void 0:r.size)&&(null==r||r.delete(e))}))},e.prototype.checkFrameQueue=function(){var t=this;if(this.clearEmptyQueue(this._frameTasks),this._frameTasks.size&&!this._frameId){var e=function(){t.handleFrameLoop(),t.requestAnimationFrame(e)};this._frameId=this.requestAnimationFrame(e)}this._frameId&&!this._frameTasks.size&&(this.cancelAnimationFrame(this._frameId),this._frameId=null)},e.prototype.checkTimerQueue=function(){var t=this;this.clearEmptyQueue(this._timerTasks),this._timerTasks.size&&!this._timerId&&(this._timerId=window.setInterval((function(){t.handleTimerLoop()}),e.__INTERVAL)),this._timerId&&!this._timerTasks.size&&(window.clearInterval(this._timerId),this._timerId=null)},e.prototype.clearFrameTask=function(t,e){var r=this._frameTasks.get(t),n=!1;return(null==r?void 0:r.has(e))&&(r.delete(e),this.checkFrameQueue(),n=!0),n},e.prototype.doOnce=function(t,e,r,n,o){void 0===n&&(n=!0);for(var u=[],a=5;a<arguments.length;a++)u[a-5]=arguments[a];return this.pushTimerTask.apply(this,s([t,e,r,1,o,n],i(u),!1))},e.prototype.doCount=function(t,e,r,n,o,u){void 0===o&&(o=!0);for(var a=[],c=6;c<arguments.length;c++)a[c-6]=arguments[c];return this.pushTimerTask.apply(this,s([t,e,r,n,u,o],i(a),!1))},e.prototype.doLoop=function(t,e,r,n,o){void 0===n&&(n=!0);for(var u=[],a=5;a<arguments.length;a++)u[a-5]=arguments[a];return this.pushTimerTask.apply(this,s([t,e,r,0,o,n],i(u),!1))},e.prototype.doFrameOnce=function(t,e,r,n,o){void 0===n&&(n=!0);for(var u=[],a=5;a<arguments.length;a++)u[a-5]=arguments[a];return this.pushFrameTask.apply(this,s([t,e,r,1,o,n],i(u),!1))},e.prototype.doFrameCount=function(t,e,r,n,o,u){void 0===o&&(o=!0);for(var a=[],c=6;c<arguments.length;c++)a[c-6]=arguments[c];return this.pushFrameTask.apply(this,s([t,e,r,n,u,o],i(a),!1))},e.prototype.doFrameLoop=function(t,e,r,n,o){void 0===n&&(n=!0);for(var u=[],a=5;a<arguments.length;a++)u[a-5]=arguments[a];return this.pushFrameTask.apply(this,s([t,e,r,0,o,n],i(u),!1))},Object.defineProperty(e.prototype,"size",{get:function(){return this._timerTasks.size+this._frameTasks.size},enumerable:!1,configurable:!0}),e.prototype.requestAnimationFrame=function(t){var e=window.requestAnimationFrame;if(!e)for(var r=["webkit","moz"],n=0;n<r.length&&!e;++n){e=window["".concat(r[n],"RequestAnimationFrame")]}if(!e){var o=0;e=function(t){var e=(new Date).getTime(),r=Math.max(0,16-(e-o)),n=window.setTimeout((function(){t&&t(e+r)}),r);return o=e+r,n}}return e(t)},e.prototype.cancelAnimationFrame=function(t){var e=window.cancelAnimationFrame;if(!e)for(var r=["webkit","moz"],n=0;n<r.length&&!e;++n){var o=r[n],i=window;e=i[o+"CancelAnimationFrame"]||i[o+"CancelRequestAnimationFrame"]}(e=e||window.clearTimeout)(t)},e.prototype.excuteTasks=function(t,e){var r=Array.from(t.values());return r.sort((function(t,e){return e.priority-t.priority})),r.forEach((function(r){!r.excute(e)&&t.delete(r.key)})),!t.size},e.prototype.excuteTaskLoop=function(t,e){var r=this;this._currTime=(new Date).getTime();var n=[];t.forEach((function(t,e){r.excuteTasks(t,r._currTime)&&n.push(e)})),n.forEach((function(e){return t.delete(e)}))},e.prototype.handleTimerLoop=function(){this._currTime=(new Date).getTime(),this.excuteTaskLoop(this._timerTasks,this._currTime),this.checkTimerQueue()},e.prototype.handleFrameLoop=function(){this._currTime=(new Date).getTime(),this.excuteTaskLoop(this._frameTasks,this._currTime),this.checkFrameQueue()},e.prototype.pushFrameTask=function(t,e,r,n,o,u){void 0===o&&(o=0),void 0===u&&(u=!0);for(var a=[],c=6;c<arguments.length;c++)a[c-6]=arguments[c];var l=this.pushTask.apply(this,s([this._frameTasks,t,e,r,n,o,u],i(a),!1));return l&&this.checkFrameQueue(),l},e.prototype.pushTask=function(t,e,r,n,o,c,l){void 0===c&&(c=0),void 0===l&&(l=!0);for(var p=[],h=7;h<arguments.length;h++)p[h-7]=arguments[h];if((!o||o<1)&&!n)return u.Handler.excute.apply(u.Handler,s([e,r],i(p),!1)),null;t.has(e)||t.set(e,new Map);var f=t.get(e);l&&(null==f?void 0:f.has(r))&&(null==f||f.delete(r));var y=new(a.bind.apply(a,s([void 0,e,r,(new Date).getTime()+n,n,l,c,o],i(p),!1)));return null==f||f.set(y.key,y),null==y?void 0:y.key},e.prototype.pushTimerTask=function(t,e,r,n,o,u){void 0===o&&(o=0),void 0===u&&(u=!0);for(var a=[],c=6;c<arguments.length;c++)a[c-6]=arguments[c];var l=this.pushTask.apply(this,s([this._timerTasks,t,e,r,n,o,u],i(a),!1));return l&&this.checkTimerQueue(),l},Object.defineProperty(e,"NAME",{get:function(){return"Timers"},enumerable:!1,configurable:!0}),e.__INTERVAL=100,e}(u.Dispatch);e.TimersImpl=c},function(t,e,r){"use strict";var n,o=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},s=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s},u=this&&this.__spreadArray||function(t,e,r){if(r||2===arguments.length)for(var n,o=0,i=e.length;o<i;o++)!n&&o in e||(n||(n=Array.prototype.slice.call(e,0,o)),n[o]=e[o]);return t.concat(n||Array.prototype.slice.call(e))};Object.defineProperty(e,"__esModule",{value:!0}),e.QueuesImpl=e.Queue=e.Task=void 0;var a=r(5),c=r(6),l=function(){function t(e,r,n,o){this._timeout=r,this._minType=e,this._id=t.createTaskId(),this._priority=o,this._data=n,this._expried=null,this._deleted=!1}return Object.defineProperty(t.prototype,"id",{get:function(){return this._id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"priority",{get:function(){return this._priority},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"data",{get:function(){return this._data},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"deled",{get:function(){return this._deleted},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"minType",{get:function(){return this._minType},enumerable:!1,configurable:!0}),t.prototype.run=function(t){this._expried=t+this._timeout},t.prototype.del=function(){this._deleted=!0},t.prototype.check=function(t){return!this._deleted&&(null===this._expried||t<this._expried)},t.createTaskId=function(){return++t._nextTaskId},t._nextTaskId=0,t}();e.Task=l;var p=function(){function t(t){this._key=t,this._tasks=new Map,this._lines=new Map,this._current=0}return Object.defineProperty(t.prototype,"key",{get:function(){return this._key},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._tasks.size},enumerable:!1,configurable:!0}),t.prototype.toString=function(){var t,e,r=[this._key];try{for(var n=i(this._lines),o=n.next();!o.done;o=n.next()){var u=s(o.value,2),a=u[0],c=u[1];r.push("".concat(a,":[").concat(c.join(","),"]"))}}catch(e){t={error:e}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}return"[".concat(r.join("=>"),"]")},t.prototype.add=function(t,e,r,n,o){return this.addTask(t,e,r,n,o)},t.prototype.remove=function(t){return this.removeTask(t)},t.prototype.next=function(){return this.nextTask()},t.prototype.lockNext=function(){var t=this._current&&this._tasks.get(this._current)||null;if(!t)return!1;var e=this._lines.get(t.priority),r=s((null==e?void 0:e.splice(1,1))||[],1)[0],n=void 0===r?0:r;if(n>0){var o=this._lines.get(a.QUE_PRIORITY.LOCKED);return!o&&this._lines.set(a.QUE_PRIORITY.LOCKED,o=[]),o.indexOf(n)<0&&o.push(n),!0}return!1},t.prototype.dispatch=function(t){var e=this._tasks.get(this._current)||null;if(null==e?void 0:e.check(t))return[null,null];var r=e;return e&&this.deleteTask(e),null==(e=this.doNext()||null)||e.run(t),this._current=(null==e?void 0:e.id)||0,[r,e]},t.prototype.doNext=function(){var t=Array.from(this._lines.keys());t.sort((function(t,e){return e>t?1:e==t?0:-1}));for(var e=void 0,r=0;r<t.length;++r){var n=t[r],o=this._lines.get(n),i=s(o||[],1)[0];if(i)if(this._tasks.has(i)){if(e=this._tasks.get(i))break}else null==o||o.splice(0,1)}return e},t.prototype.addTask=function(t,e,r,n,o){var i=this._lines.get(n);!i&&this._lines.set(n,i=[]);var u=new l(t,r,e,n);if(this._tasks.set(u.id,u),i.push(u.id),null==o?void 0:o(n,i.length)){var a=s(i,2),c=(a[0],a[1]),p=void 0===c?0:c;p&&this.removeTask(p)}return!0},t.prototype.deleteTask=function(t){var e=t.id,r=t.priority;if(e){var n=this._lines.get(r)||[],o=n.indexOf(e);o>-1&&n.splice(o,1),this._tasks.delete(e)}},t.prototype.removeTask=function(t){var e=this._tasks.get(t);return!!e&&(e.del(),t!==this._current&&this.deleteTask(e),!0)},t.prototype.nextTask=function(){return!!this._current&&this.removeTask(this._current)},t}();e.Queue=p;var h=function(t){function e(e){var r=t.call(this)||this;return r.root=e,r._queues=new Map,r.handleQueue=r.handleQueue.bind(r),r._timer=null,r._logs={},r._strategy={},r._handlers={},r}return o(e,t),e.prototype.inject=function(t,e,r){var n=(0,a.URI)(t,e);this._strategy[n]=r,this.log("inject","maxType={%1} minType={%2} strategy={%3}",t,e,!!r)},e.prototype.watch=function(t,e,r){var n=(0,a.URI)(t,e);this._handlers[n]=r,this.log("watch","maxType={%1} minType={%2} handler={%3}",t,e,!!r)},e.prototype.lockNext=function(t){this.log("lockNext","maxType={%1}",t);var e=this.checkQueue(t,!1);return!!(null==e?void 0:e.lockNext())},e.prototype.add=function(t,e,r,n,o){void 0===o&&(o=a.QUE_PRIORITY.DEFAULT);var i=(0,a.URI)(t,e),s=this.checkQueue(t),u=!!(null==s?void 0:s.add(e,r,n,o,this._strategy[i]));return u&&this.checkStart(),this.logAdd("add([size:<maxType:minType:priority:ret>])","".concat(i,":").concat(o,":").concat(!!u),(null==s?void 0:s.size)||0),u},e.prototype.onQueue=function(e,r,n){var o=(0,a.URI)(e,r);t.prototype.on.call(this,o,n)},e.prototype.offQueue=function(e,r,n){var o=(0,a.URI)(e,r);t.prototype.off.call(this,o,n)},e.prototype.remove=function(t,e){var r=this.checkQueue(t,!1),n=!!(null==r?void 0:r.remove(e));return this.logAdd("remove([size:<maxType:id:ret>])","".concat(t,":").concat(e,":").concat(!!n),(null==r?void 0:r.size)||0),n},e.prototype.next=function(t){var e=this.checkQueue(t,!1),r=!!(null==e?void 0:e.next());return this.logAdd("next([size:<maxType:ret>])","".concat(t,":").concat(!!r),(null==e?void 0:e.size)||0),r},e.prototype.doEvent=function(t,e,r){var n=(0,a.URI)(t,e.minType),o=this._handlers[n];return o&&o(e.data,r),this.emit(n,e.data,r),n},e.prototype.handleQueue=function(){var t=this,e=Array.from(this._queues.keys()),r=Date.now(),n=0,o="";e.forEach((function(e){var i=t._queues.get(e),u=s((null==i?void 0:i.dispatch(r))||[],2),a=u[0],c=void 0===a?null:a,l=u[1],p=void 0===l?null:l,h="",f="";(c||p)&&(h=c&&t.doEvent(e,c,!1)||"",f=p&&t.doEvent(e,p,!0)||"",o&&(o+="|"),o+="<[".concat(h,"]:").concat((null==c?void 0:c.priority)||0,":").concat((null==c?void 0:c.id)||0,"=>>[").concat(f,"]:").concat((null==p?void 0:p.priority)||0,":").concat((null==p?void 0:p.id)||0)),n+=(null==i?void 0:i.size)||0})),o&&this.logAdd("handle([size:<[evt]:priority:id=>[evt]:priority:id>])",o,n),n<=0&&this._timer&&(this.root.timer.clearTimer(this,this._timer),this._timer=null)},e.prototype.checkStart=function(){this._timer||(this._timer=this.root.timer.doLoop(this,this.handleQueue,e.kInterval))},e.prototype.checkQueue=function(t,e){return void 0===e&&(e=!0),!this._queues.has(t)&&e&&this._queues.set(t,new p("".concat(t))),this._queues.get(t)},e.prototype.logAdd=function(t,e,r){var n=this._logs[t]||(this._logs[t]=this.log("queues ".concat(t)));n.timeout(1e4),this.append(n,"[{%1}:<{%2}>]",r,e)},e.prototype.log=function(t,e){var r;void 0===e&&(e="");for(var n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];return(r=this.root.log).log.apply(r,u(["Queues",t,e],s(n),!1))},e.prototype.append=function(t,e){var r;void 0===e&&(e="");for(var n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];return(r=this.root.log).append.apply(r,u([t,e],s(n),!1))},e.kInterval=100,e}(c.Dispatch);e.QueuesImpl=h},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,r){"use strict";var n,o=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.Log=e.LogTask=void 0;var i=r(3),s=function(){};e.LogTask=s;var u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(i.Emitter);e.Log=u},function(t,e,r){"use strict";var n,o=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.Queues=e.QUE_PRIORITY=e.URI=void 0;var i,s=r(3);e.URI=function(t,e){return"".concat(t,":").concat(e)},function(t){t[t.DEFAULT=0]="DEFAULT",t[t.ONE=1e3]="ONE",t[t.TWO=2e3]="TWO",t[t.HTREE=3e3]="HTREE",t[t.FOUR=4e3]="FOUR",t[t.FIVE=5e3]="FIVE",t[t.SIX=6e3]="SIX",t[t.SEVEN=7e3]="SEVEN",t[t.EIGHT=8e3]="EIGHT",t[t.NINE=9e3]="NINE",t[t.MAX=1e5]="MAX",t[t.LOCKED=2e5]="LOCKED"}(i||(e.QUE_PRIORITY=i={}));var u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(s.Emitter);e.Queues=u},function(t,e,r){"use strict";var n,o=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.Timer=void 0;var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(r(3).Emitter);e.Timer=i},function(t,e,r){"use strict";var n,o=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.Sdk=void 0;var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(r(3).Emitter);e.Sdk=i},function(t,e,r){"use strict";var n,o=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s},s=this&&this.__spreadArray||function(t,e,r){if(r||2===arguments.length)for(var n,o=0,i=e.length;o<i;o++)!n&&o in e||(n||(n=Array.prototype.slice.call(e,0,o)),n[o]=e[o]);return t.concat(n||Array.prototype.slice.call(e))};Object.defineProperty(e,"__esModule",{value:!0}),e.LogImpl=void 0;var u=r(1),a=function(){function t(t,e,r,n){this._tl=Date.now(),this._type=t,this._filter=r,this._content="",this._expired=!0,this._uuid=e,this._started=0,this._title=n,this._count=0,this._timeout=0}return Object.defineProperty(t.prototype,"uuid",{get:function(){return this._uuid},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"content",{get:function(){return this._content},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"expired",{get:function(){return this._expired},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"title",{get:function(){return this._title},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"filter",{get:function(){return this._filter},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"totalkey",{get:function(){return"".concat(this._type,"_").concat(this._filter,"_").concat(this._title,"_t")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"activekey",{get:function(){return"".concat(this._type,"_").concat(this._filter,"_").concat(this._title,"_a")},enumerable:!1,configurable:!0}),t.prototype.timeout=function(t){this._timeout=t},t.prototype.append=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];return this._content+=u.format.apply(void 0,s(["\n"+t],i(e),!1)),this._expired},t.prototype.clear=function(){this._content=""},t.prototype.increase=function(){++this._count},t.prototype.begin=function(e){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];if(this._expired||!e){this._started=Date.now(),this._expired=!1,this._count=0;var o=e&&u.format.apply(void 0,s([e],i(r),!1))||"";this._content=(0,u.format)(t.kTlFmt,this._tl,o)}else this.append.apply(this,s([e],i(r),!1))},t.prototype.same=function(t){return this._content&&this._content===t.content&&this._filter===t.filter&&this._title===t.title},t.prototype.end=function(){var e=this._timeout||t.kExpired;if(Date.now()-this._started<e)return[];this._expired=!0;var r=this._title;return r&&(r+=this._count&&"[".concat(this._count+1,"]===")||"==="),r+=this._content,[this._filter,r]},t.kExpired=2e3,t.kTlFmt="tl={%1} {%2}",t}(),c=function(t){function e(e,r){var n=t.call(this)||this;return n.root=e,n._print=r||console,n._buffers=new Map,n._id=0,n._statis={},n.handlePrint=n.handlePrint.bind(n),n}return o(e,t),Object.defineProperty(e.prototype,"statis",{get:function(){return this._statis},enumerable:!1,configurable:!0}),e.prototype.init=function(){t.prototype.init.call(this),this._statis.__begin=(new Date).getTime()},e.prototype.log=function(t,r,n){for(var o=[],u=3;u<arguments.length;u++)o[u-3]=arguments[u];return this.doAppend.apply(this,s([t,e.LOG,r,n],i(o),!1))},e.prototype.debug=function(t,r,n){for(var o=[],u=3;u<arguments.length;u++)o[u-3]=arguments[u];return this.doAppend.apply(this,s([t,e.DEBUG,r,n],i(o),!1))},e.prototype.error=function(t,r,n){for(var o=[],u=3;u<arguments.length;u++)o[u-3]=arguments[u];return this.doAppend.apply(this,s([t,e.ERROR,r,n],i(o),!1))},e.prototype.info=function(t,r,n){for(var o=[],u=3;u<arguments.length;u++)o[u-3]=arguments[u];return this.doAppend.apply(this,s([t,e.INFO,r,n],i(o),!1))},e.prototype.append=function(t,e){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var o=t;o.expired?(o.begin.apply(o,s([e],i(r),!1)),this.appendTask(o.type,o)):o.append.apply(o,s([e],i(r),!1))},e.prototype.doAppend=function(t,e,r,n){for(var o=[],u=4;u<arguments.length;u++)o[u-4]=arguments[u];var c=new a(e,++this._id,t,r);return c.begin.apply(c,s([n],i(o),!1)),this.appendTask(e,c)},e.prototype.incStatis=function(t,e){void 0===e&&(e=!0);var r=t.totalkey,n=Number(this._statis[r]||0);if(this._statis[r]=++n,e){var o=t.activekey;n=Number(this._statis[o]||0),this._statis[o]=++n}},e.prototype.decStatis=function(t){var e=t.activekey,r=Number(this._statis[e]||1);this._statis[e]=r-1},e.prototype.activeCount=function(t){var e=t.activekey;return Number(this._statis[e]||1)},e.prototype.appendTask=function(t,r){this._buffers.has(t)||this._buffers.set(t,[]);var n=this._buffers.get(t)||[],o=r;if(this.activeCount(r)<=e.kHoldMax){var i=n[n.length-1];(null==i?void 0:i.same(r))?(i.increase(),o=i):(this.incStatis(r),n.push(r))}else this.incStatis(r,!1);return this._timerId=this._timerId||this.root.timer.doFrameLoop(this,this.handlePrint,e.kDelay),o},e.prototype.handlePrint=function(){var t=0;t+=this.doKindTask(e.ERROR),t+=this.doKindTask(e.LOG),t+=this.doKindTask(e.INFO),(t+=this.doKindTask(e.DEBUG))<=0&&this._timerId&&(this.root.timer.clearTimer(this,this.handlePrint),this._timerId=null)},e.prototype.doKindTask=function(t){var e=0,r=this._buffers.get(t);return r&&r.length&&(e=(r=this.doPrintTask(t,r)).length,this._buffers.set(t,r)),e},e.prototype.doPrintTask=function(t,e){for(var r=[],n=0;n<e.length;++n){var o=e[n],s=i(o.end(),2),u=s[0],a=s[1];u?(this.decStatis(o),a&&this.doPrint(t,u,a)):r.push(o)}return r},e.prototype.doPrint=function(t,e,r){var n=t&&this._print[t]||null;n&&n.call(this._print,e,r)},Object.defineProperty(e,"NAME",{get:function(){return"Log"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"LOG",{get:function(){return"log"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"DEBUG",{get:function(){return"debug"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"ERROR",{get:function(){return"error"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"INFO",{get:function(){return"info"},enumerable:!1,configurable:!0}),e.kDelay=500,e.kHoldMax=20,e}(u.Dispatch);e.LogImpl=c},function(t,e,r){"use strict";var n,o=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s},s=this&&this.__spreadArray||function(t,e,r){if(r||2===arguments.length)for(var n,o=0,i=e.length;o<i;o++)!n&&o in e||(n||(n=Array.prototype.slice.call(e,0,o)),n[o]=e[o]);return t.concat(n||Array.prototype.slice.call(e))};Object.defineProperty(e,"__esModule",{value:!0}),e.useEntry=e.EntryTarget=e.BaseEntry=void 0;var u=r(1),a=function(t){function e(e,r){var n=t.call(this,r)||this;return n.sdk=e,n}return o(e,t),e.prototype.callOnce=function(t,e){for(var r,n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];return(r=this.sdk.timer).doOnce.apply(r,s([this,t,e,void 0,void 0],i(n),!1))},e.prototype.callLoop=function(t,e){for(var r,n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];return(r=this.sdk.timer).doLoop.apply(r,s([this,t,e,void 0,void 0],i(n),!1))},e.prototype.clearLoop=function(t){this.sdk.timer.clearTimer(this,t)},e.prototype.clearOnce=function(t){this.sdk.timer.clearTimer(this,t)},e.prototype.log=function(t,e){var r;void 0===e&&(e="");for(var n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];return(r=this.sdk.log).log.apply(r,s([this.key,t,e],i(n),!1))},e.prototype.append=function(t,e){var r;void 0===e&&(e="");for(var n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];return(r=this.sdk.log).append.apply(r,s([t,e],i(n),!1))},e.prototype.format=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];return u.format.apply(void 0,s([t],i(e),!1))},e}(u.Excuter);e.BaseEntry=a;e.EntryTarget=function(t,e,r){var n=e.key;return function(e){e.key=n,e.prototype.debug=function(e,r){t.log.debug("Sdk.Load",e,r)};var o=r&&t.api.as(r)||void 0;null==o||o.add(e)}};e.useEntry=function(t,e){return(0,u.useExcuter)(t,e)}}])}));